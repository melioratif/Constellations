<!doctype html>
<html>
<head>
   <meta charset="utf-8">
   <title>Babylon - Basic scene</title>
   <style>
      html, body {
         overflow: hidden;
         background-color: black; 
         width: 100%;
         height: 100%;
         margin: 0;
         padding: 0;
      }
      #renderCanvas {
         width: 100%;
         height: 100%;
         touch-action: none;
      }
        .dropbtn {
            background-color: black;
            color: white;
            padding: 16px;
            font-size: 16px;
            border: none;
            cursor: pointer;
        }

        .dropbtn:hover, .dropbtn:focus {
            background-color: #3e8e41;
        }
        #myInput {
            background-image: url('searchicon.png');
            background-position: 14px 12px;
            background-repeat: no-repeat;
            font-size: 16px;
            padding: 14px 20px 12px 45px;
            border: none;
        }

        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #ffffff00;
            min-width: 230px;
            overflow: auto;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            height :800px;
            z-index: 1;
        }

        .dropdown-content a {
            color: white;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

        .dropdown a:hover {background-color: #ddd}

        .show {display:block;}

   </style>
   <script src="js/babylon.js"></script>
   <script src="js/hand.js"></script>
   <script src="js/constellation.js"></script>
   <script src="js/hyg.js"></script>
   <script src="js/menu.js"></script>
   <script src="js/fol_the_path.js"></script>

 <script type="text/javascript">

var _scene = null;
var cube_stars = 1000; // all stars will be inside a cube of cube_stars.
var RAW_DATA = new RawData();

var getCurrentScene  = function() {

      if (_scene != null) return _scene;

      var canvas = document.querySelector("#renderCanvas");
      var engine = new BABYLON.Engine(canvas, true);
      scene = new BABYLON.Scene(engine);
      scene.clearColor = new BABYLON.Color3(0, 0, 0);
          
//           scene.debugLayer.show();     


      var camera = new BABYLON.TargetCamera("TargetCamera", new BABYLON.Vector3(0, 0, 0), scene);
      camera.attachControl(canvas);  
      //  camera.noRotationConstraint=true;
        scene.activeCamera = camera;
       
      engine.runRenderLoop(function () {
         scene.render();
      });

      window.addEventListener("resize", function () {
         engine.resize();
      });
     
        window.addEventListener("click", function () {
                var pickResult = scene.pick(scene.pointerX, scene.pointerY);
                if (pickResult == null) return;
                if (pickResult.pickedMesh == null) return;                
                name =pickResult.pickedMesh.name;
                if (! name.startsWith("SP")) return;
                
                
                var stars = constellationsArray[name.split(":")[2]].find(name.split(":")[1]);
                var ti = document.getElementById("textinformation");             
                ti.innerHTML =   "const :"+ stars[h_con] +"&emsp;"    + "x-rel,y-rel,z-rel:"+ stars[h_x_rel] +","+stars[h_y_rel]+","+stars[h_z_rel]+"&emsp;" + "x,y,z:"+ stars[h_x] +","+stars[h_y]+","+stars[h_z]+"<br>"+
                                 "hyg  :" + stars[h_hip] +"&emsp;"    + "name:"+ stars[h_proper] +"&emsp;"+  "dist-rel:"+ stars[h_dist_rel] + "&emsp;"+  "dist:"+ stars[h_dist] +"<br>";
});

        _scene = scene;        
        return scene;

}

var drawConstellationsStars=function(scene){
        for (key in  constellationsArray){
                var cons = constellationsArray[key];
                cons.drawConstellationStars(scene);
        }
}

var drawConstellationsConnexion=function(scene){
        for (key in  constellationsArray){
                var cons = constellationsArray[key];
                cons.drawConstellationConnexion(scene);
        }

}


//https://www.babylonjs.com/demos/lens/
var init = function() {

        
        RAW_DATA.init();
        initConstellationData();
        constructMenu();

        console.log(RAW_DATA.farest_distance);
        console.log(RAW_DATA.middle_distance);

       var scene = getCurrentScene();
       drawConstellationsStars(scene);
       drawConstellationsConnexion(scene);
//       drawStarsFromADataSet(scene,all_hyg_data,["UMa"]);

}

</script>
</head>
<body onload="init()">
<button id="buttonview" class="dropbtn">View</button>
  <div id="viewDrop" class="dropdown-content" style="overflow-y: scroll">
    <input type="text" placeholder="Search.." id="myInputview"><br>
  </div>


<button id="buttonselect"  class="dropbtn">Select</button>
  <div id="selectDrop" class="dropdown-content" style="overflow-y: scroll">
    <input type="text" placeholder="Search.." id="myInputselect"><br>
  </div>

<div id="textinformation" style="position:fixed; top:10px; left:50%; color:white"></div>
<!--<div id="textinformation" style="color:white"></div>-->

<canvas id="renderCanvas"></canvas>

</body>
</html>


